<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Access Control System{% endblock %}</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="logo">Access Control System</div>
            <div class="user-info">
                <span class="user-name">John Doe</span>
                <a href="#" class="btn btn-sm">Logout</a>
            </div>
        </div>
    </header>
    
    <nav>
        <div class="container">
            <ul class="navbar" id="customNavbar">
                <li><a href="/">Dashboard</a></li>
                <li><a href="/organisations/">Organizations</a></li>
                <li><a href="/page_configs/view/">Configurations</a></li>
                <li><a href="/users/">Users</a></li>
                <li><a href="/permissions/">Permissions</a></li>
            </ul>
        </div>
    </nav>
    
    <main>
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>
    
    <footer>
        <div class="container text-center">
            <p>&copy; 2025 Access Control System</p>
        </div>
    </footer>
    
    <script>
        // DOM ready function
        function onDOMReady(callback) {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', callback);
            } else {
                callback();
            }
        }

        // Common utility functions
        const Helpers = {
            showAlert: function(message, type = 'success', container) {
                const alertElement = document.createElement('div');
                alertElement.className = `alert alert-${type}`;
                alertElement.textContent = message;
                
                // Add a close button
                const closeButton = document.createElement('button');
                closeButton.innerHTML = '&times;';
                closeButton.className = 'close';
                closeButton.style.float = 'right';
                closeButton.style.border = 'none';
                closeButton.style.background = 'none';
                closeButton.style.fontSize = '1.25rem';
                closeButton.style.cursor = 'pointer';
                closeButton.onclick = function() {
                    alertElement.remove();
                };
                
                alertElement.prepend(closeButton);
                
                // Auto-remove after 5 seconds for success messages
                if (type === 'success') {
                    setTimeout(() => {
                        alertElement.remove();
                    }, 5000);
                }
                
                // Insert at the top of the container
                container.prepend(alertElement);
            },
            
            getCsrfToken: function() {
                return document.cookie.split('; ')
                    .find(row => row.startsWith('csrftoken='))
                    ?.split('=')[1] || '';
            },
            
            formatDate: function(dateString) {
                if (!dateString) return 'N/A';
                const date = new Date(dateString);
                return date.toLocaleDateString();
            }
        };
        
        // Initialize icons
        onDOMReady(() => {
            if(typeof feather !== 'undefined') {
                feather.replace();
            }
            
            // Add active class to current nav item
            const currentPath = window.location.pathname;
            document.querySelectorAll('.navbar a').forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                } else if (currentPath.includes(link.getAttribute('href')) && link.getAttribute('href') !== '/') {
                    link.classList.add('active');
                }
            });
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
